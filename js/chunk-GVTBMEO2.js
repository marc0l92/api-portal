// Project: https://github.com/marc0l92/api-tools
import{h as a}from"./chunk-QOPUWAMH.js";a();a();a();var m=class extends Error{},d=(i,t,e)=>{for(let r in i){if(r==="$ref"&&typeof i[r]=="string")return e(i,i.$ref,t);typeof i[r]=="object"&&(i[r]=d(i[r],`${t}/${r}`,e))}return i},P=(i,t)=>{if(!t.startsWith("#/"))throw new Error("Only local references are supported");let e=t.substring(2).split("/"),r=i;for(let n of e)if(n in r)r=r[n];else throw new m(`Reference not found: ${t}`);return r},M=(i,t)=>{let e=Object.assign({},i);return delete e.$ref,Object.assign({},t,e)},D=(i,t,e,r)=>(typeof t=="object"&&(t=d(t,e,(n,s,u)=>{let c={};if(r.indexOf(s)===-1&&!u.startsWith(s)&&(r.push(s),c=P(i,s),c=D(i,c,u,r),r.pop(),typeof c!="object"))throw new Error(`Reference to not object items forbidden: ${s}`);return M(n,c)})),t),v=i=>D(i,i,"#",[]);var o=class{constructor(t){this.apiDoc=null;this.apiDoc=t}setModelsTitle(){let t=this.getModels();for(let e in t)t[e].hasOwnProperty("title")||(t[e].title=e)}async resolveReferences(){this.apiDoc=await v(this.apiDoc)}getStatus(){return this.apiDoc["x-metadata"]&&this.apiDoc["x-metadata"].status?this.apiDoc["x-metadata"].status:0}getMetadata(){let t=this.apiDoc["x-metadata"],e={};for(let r in t)typeof t[r]=="string"?e[r]=t[r]:e[r]=JSON.stringify(t[r]);return e}toJson(){return this.apiDoc}},p=class{constructor(){this.requestParameters=[];this.request=null;this.responses={}}setPath(t){this.path=t}getPath(){return this.path}setMethod(t){this.method=t}getMethod(){return this.method}addGlobalParameters(t){this.requestParameters=this.requestParameters.concat(t)}getName(){return`${this.method.toUpperCase()} ${this.path}`}getRequestParameters(){return this.requestParameters}getRequest(){return this.request}getResponses(){return this.responses}};a();var x=["get","put","post","delete","options","head","patch","trace"],h=class extends o{getApi(){return this.apiDoc}getName(){return this.getApi().info&&this.getApi().info.title?this.getApi().info.title:"api"}getVersion(){return this.getApi().info&&this.getApi().info.version?this.getApi().info.version:"0"}getServices(){let t=[];for(let e in this.getApi().paths){let r=this.getApi().paths[e].parameters||[];for(let n in this.getApi().paths[e])if(x.indexOf(n)>=0){let s=new l(this.getApi().paths[e][n]);s.setPath(e),s.setMethod(n),s.addGlobalParameters(r),t.push(s)}}return t}getModels(){return this.getApi().components&&this.getApi().components.schemas?this.getApi().components.schemas:{}}getReleaseNotes(){return this.getApi()&&this.getApi().info&&this.getApi().info["x-release-note"]?this.getApi().info["x-release-note"]:null}getType(){return 3}},l=class extends p{constructor(e){super();this.serviceDoc=null;this.serviceDoc=e,this.initParameters(),this.initRequest(),this.initResponse()}initParameters(){this.serviceDoc.parameters&&(this.requestParameters=this.serviceDoc.parameters)}initRequest(){this.serviceDoc.requestBody&&this.serviceDoc.requestBody.content&&this.serviceDoc.requestBody.content["application/json"]&&(this.request=this.serviceDoc.requestBody.content["application/json"])}initResponse(){if(this.serviceDoc.responses)for(let e in this.serviceDoc.responses){let r=this.serviceDoc.responses[e];r.content&&r.content["application/json"]&&(this.responses[e]=r.content["application/json"])}}};a();var A=class extends o{getApi(){return this.apiDoc}getName(){return this.getApi().info&&this.getApi().info.title?this.getApi().info.title:"api"}getVersion(){return this.getApi().info&&this.getApi().info.version?this.getApi().info.version:"0"}getServices(){let t=[];for(let e in this.getApi().paths){let r=this.getApi().paths[e].parameters||[];for(let n in this.getApi().paths[e])if(n!=="parameters"){let s=new f(this.getApi().paths[e][n]);s.setPath(e),s.setMethod(n),s.addGlobalParameters(r),t.push(s)}}return t}getModels(){return this.getApi().definitions?this.getApi().definitions:{}}getReleaseNotes(){return this.getApi()&&this.getApi().info&&this.getApi().info["x-release-note"]?this.getApi().info["x-release-note"]:null}getType(){return 2}},f=class extends p{constructor(e){super();this.serviceDoc=null;this.serviceDoc=e,this.initParameters(),this.initRequest(),this.initResponse()}initParameters(){this.serviceDoc.parameters&&(this.requestParameters=this.serviceDoc.parameters.filter(e=>e.in==="path"||e.in==="query"||e.in==="header"))}initRequest(){if(this.serviceDoc.parameters){let e=this.serviceDoc.parameters.find(r=>r.in==="body");e&&(this.request=e)}}initResponse(){this.serviceDoc.responses&&(this.responses=this.serviceDoc.responses)}};var S=i=>{if(i.swagger==="2.0")return 2;if(i.openapi&&i.openapi.startsWith("3"))return 3;throw new Error("Api version not recognized")},V=i=>{switch(S(i)){case 2:return new A(i);case 3:return new h(i)}throw new Error("Api not recognized")};export{S as a,V as b};
